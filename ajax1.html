<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
	</body>
	<script type="text/javascript">
		/*-------------------Ajax start--------------------*/
		
		obj={
			"url":"ajax.txt",
			"success":function(a){
				console.log(a)
			}
		}
ajax(obj)
function ajax(options) {
    options = options || {};
    options.type = (options.type || "GET").toUpperCase();
    options.dataType = options.dataType || "json";
    var params = formatParams(options.data);
    var xhr;
 
    //创建 - 第一步
    if (window.XMLHttpRequest) {
      xhr = new XMLHttpRequest();
    } else if(window.ActiveObject) {         //IE6及以下
      xhr = new ActiveXObject('Microsoft.XMLHTTP');
    }
 
    //连接 和 发送 - 第二步
    if (options.type == "GET") {
      xhr.open("GET", options.url + "?" + params, true);
      xhr.send(null);
    } else if (options.type == "POST") {
      xhr.open("POST", options.url, true);
      //设置表单提交时的内容类型
      xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xhr.send(params);
    }

     //接收 - 第三步
    xhr.onreadystatechange = function () {
      if (xhr.readyState == 4) {
        var status = xhr.status;
        if (status >= 200 && status < 300 || status == 304) {
          options.success && options.success(xhr.responseText, xhr.responseXML);
          console.log(xhr.getResponseHeader("Content-Type"))
        } else {
          options.error && options.error(status);  
        }
      }
    }
  }

//格式化参数
function formatParams(data){
    var arr = [];
    for (var name in data) {
      arr.push(encodeURIComponent(name) + "=" + encodeURIComponent(data[name]));
    }
    arr.push(("v=" + Math.random()).replace(".",""));
    return arr.join("&");
}

/*-------------------Ajax end-------------------*/
	</script>
</html>
